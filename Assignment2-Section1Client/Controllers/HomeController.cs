using Assignment2_Section1;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;

namespace Assignment2_Section1Client.Controllers
{
    public class HomeController : Controller
    {
        public ActionResult Index()
        {
            List<Employee> employees = new List<Employee>();
            EmployeeClient.EmployeeServiceClient client = new EmployeeClient.EmployeeServiceClient();
            var response = client.RetrieveEmployees();
            foreach (var emp in response)
            {
                Employee employee = new Employee();
                employee.EmpNo = emp.EmpNo;
                employee.EmpFName = emp.EmpFName;
                employee.EmpLName = emp.EmpLName;
                employee.Dept = emp.Dept;
                employees.Add(employee);
            }
            return View(employees);
        }
        public ActionResult Details(int id)
        {
            EmployeeClient.EmployeeServiceClient client = new EmployeeClient.EmployeeServiceClient();
            var emp = client.RetrieveEmployeeByID(id);
            Employee employee = new Employee();
            employee.EmpNo = emp.EmpNo;
            employee.EmpFName = emp.EmpFName;
            employee.EmpLName = emp.EmpLName;
            employee.Dept = emp.Dept;
            return View(employee);
        }

        public ActionResult Delete(int id)
        {
            EmployeeClient.EmployeeServiceClient client = new EmployeeClient.EmployeeServiceClient();
            int result = client.DeleteEmployees(id);
            if (result == 1)
                ViewBag.Message = "The emp no with id:" + id + " is deleted.";
            else
                ViewBag.Message = "Record is not deleted. Please try again.";
            return View();
        }
        [HttpGet]
        public ActionResult Edit(int id)
        {
            EmployeeClient.EmployeeServiceClient client = new EmployeeClient.EmployeeServiceClient();
            var emp = client.RetrieveEmployeeByID(id);
            Employee employee = new Employee();
            employee.EmpNo = emp.EmpNo;
            employee.EmpFName = emp.EmpFName;
            employee.EmpLName = emp.EmpLName;
            employee.Dept = emp.Dept;
            return View(employee);
        }

        [HttpPost]
        public ActionResult Edit(int id, FormCollection collection)
        {
            EmployeeClient.EmployeeServiceClient client = new EmployeeClient.EmployeeServiceClient();
            EmployeeClient.Employee employee = new EmployeeClient.Employee();
            Employee emp = new Employee();
            employee.EmpNo = emp.EmpNo = Convert.ToInt32(collection["EmpNo"]);
            employee.EmpFName = emp.EmpFName = collection["EmpFName"];
            employee.EmpLName = emp.EmpLName = collection["EmpLName"];
            employee.Dept = emp.Dept = collection["Dept"];
            int result = client.UpdateEmployees(id, employee);
            if (result == 1)
                ViewBag.Message = "The emp no with id:" + id + " is updated.";
            else
                ViewBag.Message = "Record is not updated. Please try again.";
            return View(emp);
        }
        [HttpGet]
        public ActionResult Create()
        {
            return View();
        }

        [HttpPost]
        public ActionResult Create(Employee emp)
        {
            EmployeeClient.EmployeeServiceClient client = new EmployeeClient.EmployeeServiceClient();
            EmployeeClient.Employee employee = new EmployeeClient.Employee();
            employee.EmpNo = emp.EmpNo;
            employee.EmpFName = emp.EmpFName;
            employee.EmpLName = emp.EmpLName;
            employee.Dept = emp.Dept;
            int result = client.AddEmployees(employee);
            if (result == 1)
                ViewBag.Message = "The emp no with id:" + emp.EmpNo + " is added.";
            else
                ViewBag.Message = "Record is not added. Please try again.";
            return View(emp);
        }
    }
}





























































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































